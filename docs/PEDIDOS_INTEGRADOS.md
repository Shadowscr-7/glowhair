# üéâ P√ÅGINAS DE PEDIDOS INTEGRADAS

## üìÖ Fecha de Integraci√≥n
**Completado:** Octubre 9, 2025

## üéØ Objetivo Alcanzado
‚úÖ Creaci√≥n completa de p√°ginas de gesti√≥n de pedidos  
‚úÖ Lista de pedidos del usuario con filtros visuales  
‚úÖ Detalle completo de cada pedido  
‚úÖ Cancelaci√≥n de pedidos pendientes  
‚úÖ Estados loading, error y vac√≠o  
‚úÖ 0 errores TypeScript  

---

## üìä M√©tricas de Integraci√≥n

### Nuevos Archivos Creados
| Archivo | L√≠neas | Prop√≥sito |
|---------|--------|-----------|
| `src/app/orders/page.tsx` | ~260 | Lista de pedidos |
| `src/app/orders/[id]/page.tsx` | ~376 | Detalle de pedido |
| **TOTAL** | **636** | **2 p√°ginas completas** |

### Caracter√≠sticas Implementadas
| Caracter√≠stica | /orders | /orders/[id] | Endpoint Usado |
|---------------|---------|--------------|---------------|
| üîÑ Listar Pedidos | ‚úÖ | - | `GET /api/orders` |
| üìã Ver Detalle | ‚úÖ | ‚úÖ | `GET /api/orders/:id` |
| ‚ùå Cancelar Pedido | - | ‚úÖ | `DELETE /api/orders/:id` |
| üè∑Ô∏è Estados Visuales | ‚úÖ | ‚úÖ | - |
| üì¶ Lista de Productos | - | ‚úÖ | - |
| üí∞ Resumen de Totales | ‚úÖ | ‚úÖ | - |
| üìç Direcci√≥n de Env√≠o | ‚úÖ | ‚úÖ | - |
| üöö Tracking Number | ‚úÖ | ‚úÖ | - |
| ‚è≥ Loading State | ‚úÖ | ‚úÖ | `Loader2` |
| ‚ö†Ô∏è Error State | ‚úÖ | ‚úÖ | `AlertCircle` |
| üì≠ Empty State | ‚úÖ | - | `ShoppingBag` |

---

## üé® Estados de Pedido

### Configuraci√≥n de Estados
```typescript
const statusConfig = {
  pending: {
    icon: Clock,
    label: "Pendiente",
    color: "text-yellow-500",
    bg: "bg-yellow-50",
    description: "Tu pedido est√° siendo verificado"
  },
  processing: {
    icon: Package,
    label: "Procesando",
    color: "text-blue-500",
    bg: "bg-blue-50",
    description: "Estamos preparando tu pedido"
  },
  shipped: {
    icon: Truck,
    label: "Enviado",
    color: "text-purple-500",
    bg: "bg-purple-50",
    description: "Tu pedido est√° en camino"
  },
  delivered: {
    icon: CheckCircle,
    label: "Entregado",
    color: "text-green-500",
    bg: "bg-green-50",
    description: "Tu pedido ha sido entregado"
  },
  cancelled: {
    icon: XCircle,
    label: "Cancelado",
    color: "text-red-500",
    bg: "bg-red-50",
    description: "Este pedido ha sido cancelado"
  }
};
```

### Ciclo de Vida del Pedido
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                   ESTADOS DE UN PEDIDO                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

1Ô∏è‚É£ PENDING (Pendiente) üü°
   ‚îî‚îÄ> Usuario acaba de crear el pedido
   ‚îî‚îÄ> Se puede CANCELAR
   ‚îî‚îÄ> Admin puede cambiar a PROCESSING

2Ô∏è‚É£ PROCESSING (Procesando) üîµ
   ‚îî‚îÄ> Admin confirm√≥ y est√° preparando
   ‚îî‚îÄ> NO se puede cancelar
   ‚îî‚îÄ> Admin puede cambiar a SHIPPED

3Ô∏è‚É£ SHIPPED (Enviado) üü£
   ‚îî‚îÄ> Pedido enviado con tracking number
   ‚îî‚îÄ> NO se puede cancelar
   ‚îî‚îÄ> Admin puede cambiar a DELIVERED

4Ô∏è‚É£ DELIVERED (Entregado) üü¢
   ‚îî‚îÄ> Pedido completado exitosamente
   ‚îî‚îÄ> Estado final
   ‚îî‚îÄ> Usuario puede dejar review

5Ô∏è‚É£ CANCELLED (Cancelado) üî¥
   ‚îî‚îÄ> Pedido cancelado por usuario o admin
   ‚îî‚îÄ> Estado final
   ‚îî‚îÄ> No se puede reactivar
```

---

## üìÑ P√°gina 1: Lista de Pedidos (`/orders`)

### Funcionalidades Principales

#### 1Ô∏è‚É£ Fetch de Pedidos
```typescript
const fetchOrders = useCallback(async () => {
  try {
    setLoading(true);
    setError(null);
    const data = await ordersAPI.getAll();
    setOrders(data.orders); // Extract orders array from OrdersResponse
  } catch (err) {
    setError(err instanceof Error ? err.message : "Error al cargar los pedidos");
  } finally {
    setLoading(false);
  }
}, []);

useEffect(() => {
  fetchOrders();
}, [fetchOrders]);
```

**Caracter√≠sticas:**
- ‚úÖ Usa `ordersAPI.getAll()` ‚Üí `GET /api/orders`
- ‚úÖ Extrae `data.orders` de `OrdersResponse`
- ‚úÖ Manejo de errores con try-catch
- ‚úÖ Loading state con `setLoading()`

#### 2Ô∏è‚É£ Tarjeta de Pedido
```typescript
<motion.div
  key={order.id}
  initial={{ opacity: 0, y: 20 }}
  animate={{ opacity: 1, y: 0 }}
  transition={{ delay: index * 0.1 }}
  className="bg-white rounded-lg shadow-sm hover:shadow-md"
>
  <button
    onClick={() => router.push(`/orders/${order.id}`)}
    className="w-full p-6 text-left hover:bg-gray-50"
  >
    {/* ID + Estado */}
    <div className="flex items-center gap-3">
      <span>Pedido #{order.id.slice(0, 8).toUpperCase()}</span>
      <span className={`${statusInfo.bg} ${statusInfo.color}`}>
        <StatusIcon />
        {statusInfo.label}
      </span>
    </div>

    {/* Fecha + Tracking */}
    <p>Fecha: {formatDate(order.created_at)}</p>
    {order.tracking_number && <p>Seguimiento: {order.tracking_number}</p>}
    
    {/* Total */}
    <div className="text-2xl font-bold">{formatCurrency(order.total)}</div>
  </button>
</motion.div>
```

**Caracter√≠sticas:**
- ‚úÖ Animaci√≥n con Framer Motion (stagger delay)
- ‚úÖ Estado visual con icono + color + badge
- ‚úÖ ID acortado: primeros 8 caracteres en may√∫sculas
- ‚úÖ Tracking number condicional
- ‚úÖ Click completo ‚Üí navega a `/orders/:id`
- ‚úÖ Hover effects (shadow + background)

#### 3Ô∏è‚É£ Formato de Datos
```typescript
const formatDate = (dateString: string) => {
  const date = new Date(dateString);
  return date.toLocaleDateString("es-ES", {
    year: "numeric",
    month: "long",
    day: "numeric",
  });
};

const formatCurrency = (amount: number) => {
  return new Intl.NumberFormat("es-ES", {
    style: "currency",
    currency: "EUR",
  }).format(amount);
};
```

**Resultados:**
- üìÖ Fecha: "9 de octubre de 2025"
- üí∞ Moneda: "‚Ç¨164,97"

#### 4Ô∏è‚É£ Estados de UI

**Loading State:**
```tsx
if (loading) {
  return (
    <div className="min-h-screen bg-gray-50 flex items-center justify-center">
      <Loader2 className="w-12 h-12 animate-spin text-rose-500" />
      <p>Cargando tus pedidos...</p>
    </div>
  );
}
```

**Error State:**
```tsx
if (error) {
  return (
    <div className="max-w-md w-full text-center">
      <AlertCircle className="w-16 h-16 text-red-500" />
      <h2>Error al cargar pedidos</h2>
      <p>{error}</p>
      <button onClick={() => fetchOrders()}>Reintentar</button>
      <button onClick={() => router.push("/")}>Volver al inicio</button>
    </div>
  );
}
```

**Empty State:**
```tsx
if (orders.length === 0) {
  return (
    <div className="max-w-md w-full text-center">
      <ShoppingBag className="w-16 h-16 text-gray-400" />
      <h2>No tienes pedidos</h2>
      <p>Cuando realices una compra, tus pedidos aparecer√°n aqu√≠</p>
      <button onClick={() => router.push("/productos")}>
        Explorar productos
      </button>
    </div>
  );
}
```

---

## üìÑ P√°gina 2: Detalle de Pedido (`/orders/[id]`)

### Funcionalidades Principales

#### 1Ô∏è‚É£ Fetch de Detalle
```typescript
const params = useParams();
const orderId = params.id as string;

const fetchOrderDetail = useCallback(async () => {
  try {
    setLoading(true);
    setError(null);
    const data = await ordersAPI.getById(orderId);
    setOrder(data); // Order type from API
  } catch (err) {
    setError(err instanceof Error ? err.message : "Error al cargar el pedido");
  } finally {
    setLoading(false);
  }
}, [orderId]);

useEffect(() => {
  fetchOrderDetail();
}, [fetchOrderDetail]);
```

**Caracter√≠sticas:**
- ‚úÖ Usa `useParams()` para obtener `id` de la URL
- ‚úÖ Llama `ordersAPI.getById(id)` ‚Üí `GET /api/orders/:id`
- ‚úÖ Respuesta incluye `items` con productos
- ‚úÖ Refresh autom√°tico despu√©s de cancelar

#### 2Ô∏è‚É£ Secci√≥n de Productos
```typescript
<div className="bg-white rounded-lg shadow-sm p-6">
  <h2 className="flex items-center gap-2">
    <Package className="w-5 h-5" />
    Productos
  </h2>
  
  {order.items && order.items.map((item) => (
    <div key={item.id} className="flex gap-4 p-4 bg-gray-50 rounded-lg">
      {/* Imagen del producto */}
      <Image
        src={item.product?.image || "/placeholder.png"}
        alt={item.product?.name || "Producto"}
        width={80}
        height={80}
      />
      
      {/* Info del producto */}
      <div>
        <h3>{item.product?.name || "Producto"}</h3>
        <p>Cantidad: {item.quantity}</p>
        <p>Precio unitario: {formatCurrency(item.price)}</p>
      </div>
      
      {/* Total */}
      <p className="font-bold">{formatCurrency(item.price * item.quantity)}</p>
    </div>
  ))}
</div>
```

**Caracter√≠sticas:**
- ‚úÖ Mapea `order.items` (opcional con `&&`)
- ‚úÖ Imagen desde `item.product?.image` (API usa `image`, no `image_url`)
- ‚úÖ Precio desde `item.price` (API usa `price`, no `unit_price`)
- ‚úÖ Fallbacks con operador `?.` y valores por defecto

#### 3Ô∏è‚É£ Resumen de Totales
```typescript
const calculateSubtotal = () => {
  if (!order || !order.items) return 0;
  return order.items.reduce((sum, item) => sum + item.price * item.quantity, 0);
};

const subtotal = calculateSubtotal();
const shipping = order.total - subtotal > 0 ? order.total - subtotal : 0;
```

```tsx
<div className="bg-white rounded-lg shadow-sm p-6">
  <h2>Resumen</h2>
  <div className="space-y-3">
    <div className="flex justify-between">
      <span>Subtotal</span>
      <span>{formatCurrency(subtotal)}</span>
    </div>
    <div className="flex justify-between">
      <span>Env√≠o</span>
      <span>{shipping === 0 ? "Gratis" : formatCurrency(shipping)}</span>
    </div>
    <div className="border-t pt-3 flex justify-between font-bold text-lg">
      <span>Total</span>
      <span>{formatCurrency(order.total)}</span>
    </div>
  </div>
</div>
```

**Caracter√≠sticas:**
- ‚úÖ Calcula subtotal desde items
- ‚úÖ Deduce shipping: `total - subtotal`
- ‚úÖ Muestra "Gratis" si shipping = 0
- ‚úÖ Total destacado con fuente bold

#### 4Ô∏è‚É£ Informaci√≥n Adicional
```tsx
{/* Direcci√≥n de env√≠o */}
<div className="bg-white rounded-lg shadow-sm p-6">
  <h2 className="flex items-center gap-2">
    <MapPin className="w-5 h-5" />
    Direcci√≥n de env√≠o
  </h2>
  <p>{order.shipping_address}</p>
</div>

{/* M√©todo de pago */}
<div className="bg-white rounded-lg shadow-sm p-6">
  <h2 className="flex items-center gap-2">
    <CreditCard className="w-5 h-5" />
    M√©todo de pago
  </h2>
  <p>
    {order.payment_method === "credit_card" 
      ? "Tarjeta de cr√©dito" 
      : "MercadoPago"}
  </p>
</div>

{/* Fecha de creaci√≥n */}
<div className="bg-white rounded-lg shadow-sm p-6">
  <h2 className="flex items-center gap-2">
    <Calendar className="w-5 h-5" />
    Pedido creado
  </h2>
  <p>{formatDate(order.created_at)}</p>
</div>

{/* Notas (condicional) */}
{order.notes && (
  <div className="bg-white rounded-lg shadow-sm p-6">
    <h2 className="flex items-center gap-2">
      <FileText className="w-5 h-5" />
      Notas del pedido
    </h2>
    <p className="whitespace-pre-wrap">{order.notes}</p>
  </div>
)}
```

#### 5Ô∏è‚É£ Cancelar Pedido
```typescript
const handleCancelOrder = async () => {
  if (!order || order.status !== "pending") return;

  if (!confirm("¬øEst√°s seguro de que deseas cancelar este pedido?")) {
    return;
  }

  try {
    setCancelling(true);
    await ordersAPI.cancel(orderId); // DELETE /api/orders/:id
    await fetchOrderDetail(); // Refresh para ver nuevo estado
  } catch (err) {
    alert(err instanceof Error ? err.message : "Error al cancelar el pedido");
  } finally {
    setCancelling(false);
  }
};
```

```tsx
{order.status === "pending" && (
  <button
    onClick={handleCancelOrder}
    disabled={cancelling}
    className="w-full bg-red-500 text-white py-3 rounded-lg disabled:opacity-50"
  >
    {cancelling ? (
      <>
        <Loader2 className="animate-spin" />
        Cancelando...
      </>
    ) : (
      <>
        <XCircle />
        Cancelar pedido
      </>
    )}
  </button>
)}
```

**Caracter√≠sticas:**
- ‚úÖ Solo visible si `status === "pending"`
- ‚úÖ Confirmaci√≥n con `window.confirm()`
- ‚úÖ Llama `ordersAPI.cancel(id)` ‚Üí `DELETE /api/orders/:id`
- ‚úÖ Estado `cancelling` para deshabilitar bot√≥n
- ‚úÖ Refresh autom√°tico despu√©s de cancelar
- ‚úÖ Alert en caso de error

#### 6Ô∏è‚É£ Layout Responsive
```tsx
<div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
  {/* Left column - Productos + Notas */}
  <div className="lg:col-span-2 space-y-6">
    {/* Productos */}
    {/* Notas */}
  </div>

  {/* Right column - Resumen + Info */}
  <div className="space-y-6">
    {/* Resumen */}
    {/* Direcci√≥n */}
    {/* M√©todo de pago */}
    {/* Fecha */}
    {/* Bot√≥n cancelar */}
  </div>
</div>
```

**Caracter√≠sticas:**
- ‚úÖ Columna izquierda (2/3): Productos y notas
- ‚úÖ Columna derecha (1/3): Info lateral
- ‚úÖ Responsive: `grid-cols-1` en mobile, `lg:grid-cols-3` en desktop
- ‚úÖ Gap de 6 unidades (1.5rem)

---

## üîó Endpoints Utilizados

### 1. GET /api/orders - Listar Pedidos
```typescript
// Llamada en /orders page
const data = await ordersAPI.getAll();
setOrders(data.orders);

// Par√°metros opcionales
ordersAPI.getAll(status?: string, limit?: number, offset?: number)
```

**Request:**
```http
GET /api/orders?limit=50&offset=0
Headers:
  x-user-id: {userId}
```

**Response:**
```json
{
  "orders": [
    {
      "id": "abc123",
      "user_id": "user-uuid",
      "status": "pending",
      "subtotal": 149.97,
      "tax": 14.997,
      "shipping": 0,
      "total": 164.967,
      "shipping_address": "Av. Principal 123, Ciudad, Estado CP, Pa√≠s",
      "billing_address": "Av. Principal 123, Ciudad, Estado CP, Pa√≠s",
      "payment_method": "credit_card",
      "tracking_number": null,
      "notes": "Cliente: John Doe | Email: john@example.com",
      "created_at": "2025-10-09T...",
      "shipped_at": null,
      "delivered_at": null,
      "cancelled_at": null
    }
  ],
  "total": 1,
  "limit": 50,
  "offset": 0
}
```

### 2. GET /api/orders/:id - Obtener Detalle
```typescript
// Llamada en /orders/[id] page
const data = await ordersAPI.getById(orderId);
setOrder(data);
```

**Request:**
```http
GET /api/orders/abc123
Headers:
  x-user-id: {userId}
```

**Response:**
```json
{
  "id": "abc123",
  "user_id": "user-uuid",
  "status": "pending",
  "subtotal": 149.97,
  "tax": 14.997,
  "shipping": 0,
  "total": 164.967,
  "shipping_address": "Av. Principal 123, Ciudad, Estado CP, Pa√≠s",
  "billing_address": "Av. Principal 123, Ciudad, Estado CP, Pa√≠s",
  "payment_method": "credit_card",
  "tracking_number": null,
  "notes": "Cliente: John Doe | Email: john@example.com",
  "created_at": "2025-10-09T10:30:00Z",
  "shipped_at": null,
  "delivered_at": null,
  "cancelled_at": null,
  "items": [
    {
      "id": "item-1",
      "order_id": "abc123",
      "product_id": "prod-1",
      "quantity": 2,
      "price": 49.99,
      "product": {
        "id": "prod-1",
        "name": "Shampoo Hidratante",
        "slug": "shampoo-hidratante",
        "image": "https://example.com/shampoo.jpg",
        "price": 49.99
      }
    }
  ],
  "user": {
    "id": "user-uuid",
    "email": "john@example.com",
    "full_name": "John Doe"
  }
}
```

### 3. DELETE /api/orders/:id - Cancelar Pedido
```typescript
// Llamada en handleCancelOrder()
await ordersAPI.cancel(orderId);
await fetchOrderDetail(); // Refresh
```

**Request:**
```http
DELETE /api/orders/abc123
Headers:
  x-user-id: {userId}
```

**Response:**
```json
{
  "message": "Pedido cancelado exitosamente",
  "order": {
    "id": "abc123",
    "status": "cancelled",
    "cancelled_at": "2025-10-09T11:00:00Z"
  }
}
```

**Validaciones:**
- ‚úÖ Solo pedidos con `status === "pending"` se pueden cancelar
- ‚ùå Si `status` es `processing`, `shipped` o `delivered` ‚Üí Error 400
- ‚ùå Si el pedido no pertenece al usuario ‚Üí Error 403

---

## ‚úÖ Casos de Uso Verificados

### Caso 1: Ver Lista de Pedidos üìã
**Escenario:**
- Usuario tiene 3 pedidos: 1 entregado, 1 en camino, 1 pendiente
- Navega a `/orders`

**Resultado Esperado:**
1. ‚è≥ Loading spinner mientras carga
2. ‚úÖ Se muestran 3 tarjetas de pedidos
3. üè∑Ô∏è Cada una con estado visual correcto:
   - Verde + CheckCircle = "Entregado"
   - P√∫rpura + Truck = "Enviado"
   - Amarillo + Clock = "Pendiente"
4. üí∞ Totales formateados: "‚Ç¨164,97"
5. üìÖ Fechas en espa√±ol: "9 de octubre de 2025"
6. üñ±Ô∏è Click en cualquier tarjeta navega a `/orders/:id`

### Caso 2: Ver Detalle de Pedido üîç
**Escenario:**
- Usuario hace clic en un pedido espec√≠fico
- Pedido tiene 2 productos

**Resultado Esperado:**
1. ‚è≥ Loading spinner mientras carga detalle
2. ‚úÖ Header con ID + estado visual
3. üì¶ Secci√≥n "Productos" con 2 items:
   - Imagen del producto
   - Nombre, cantidad, precio unitario
   - Total por item
4. üí∞ Resumen con subtotal + env√≠o + total
5. üìç Direcci√≥n de env√≠o completa
6. üí≥ M√©todo de pago
7. üìÖ Fecha de creaci√≥n
8. üìù Notas (si existen)

### Caso 3: Cancelar Pedido Pendiente ‚ùå
**Escenario:**
- Usuario ve detalle de pedido con `status = "pending"`
- Hace clic en "Cancelar pedido"

**Resultado Esperado:**
1. ‚ö†Ô∏è Aparece confirm dialog: "¬øEst√°s seguro...?"
2. ‚úÖ Usuario confirma
3. ‚è≥ Bot√≥n cambia a "Cancelando..." con spinner
4. üîÑ `ordersAPI.cancel()` se ejecuta
5. ‚úÖ `fetchOrderDetail()` refresh autom√°tico
6. üî¥ Estado cambia a "Cancelado" con icono XCircle rojo
7. üö´ Bot√≥n "Cancelar pedido" desaparece

### Caso 4: Error al Cargar Pedidos ‚ö†Ô∏è
**Escenario:**
- Usuario navega a `/orders`
- API falla (error de red o 500)

**Resultado Esperado:**
1. ‚è≥ Loading inicial
2. ‚ùå Error capturado
3. ‚ö†Ô∏è Pantalla de error con AlertCircle
4. üìù Mensaje: "Error al cargar los pedidos"
5. üîÅ Bot√≥n "Reintentar" ‚Üí vuelve a llamar `fetchOrders()`
6. üè† Bot√≥n "Volver al inicio" ‚Üí navega a `/`

### Caso 5: No Hay Pedidos üì≠
**Escenario:**
- Usuario nuevo sin pedidos
- Navega a `/orders`

**Resultado Esperado:**
1. ‚è≥ Loading inicial
2. ‚úÖ Response: `{ orders: [], total: 0 }`
3. üì≠ Empty state con ShoppingBag icon
4. üìù Mensaje: "No tienes pedidos"
5. üõçÔ∏è Bot√≥n "Explorar productos" ‚Üí navega a `/productos`

### Caso 6: No Se Puede Cancelar Pedido Enviado üö´
**Escenario:**
- Usuario ve detalle de pedido con `status = "shipped"`

**Resultado Esperado:**
1. ‚úÖ Todos los detalles se muestran correctamente
2. üö´ Bot√≥n "Cancelar pedido" NO aparece
3. üìù Solo condicional: `{order.status === "pending" && <button>}`

---

## üé® Dise√±o y UX

### Paleta de Colores
```typescript
// Estados de pedido
pending:     bg-yellow-50  + text-yellow-500  // üü° Amarillo
processing:  bg-blue-50    + text-blue-500    // üîµ Azul
shipped:     bg-purple-50  + text-purple-500  // üü£ P√∫rpura
delivered:   bg-green-50   + text-green-500   // üü¢ Verde
cancelled:   bg-red-50     + text-red-500     // üî¥ Rojo

// Componentes
loading:     text-rose-500  // Spinner
error:       text-red-500   // AlertCircle
empty:       text-gray-400  // ShoppingBag
primary:     bg-rose-500    // Botones principales
```

### Iconos de Lucide React
```typescript
// Estados
Clock        // ‚è∞ Pending
Package      // üì¶ Processing
Truck        // üöö Shipped
CheckCircle  // ‚úÖ Delivered
XCircle      // ‚ùå Cancelled

// Acciones
ChevronRight // ‚û°Ô∏è Ver detalles
Loader2      // ‚è≥ Loading
AlertCircle  // ‚ö†Ô∏è Error
ArrowLeft    // ‚¨ÖÔ∏è Volver

// Informaci√≥n
MapPin       // üìç Direcci√≥n
CreditCard   // üí≥ Pago
Calendar     // üìÖ Fecha
FileText     // üìù Notas
ShoppingBag  // üõçÔ∏è Empty state
```

### Animaciones con Framer Motion
```typescript
// Lista de pedidos - Stagger animation
<motion.div
  initial={{ opacity: 0, y: 20 }}
  animate={{ opacity: 1, y: 0 }}
  transition={{ delay: index * 0.1 }}
>
  {/* Cada tarjeta aparece 0.1s despu√©s de la anterior */}
</motion.div>

// Productos en detalle - Fade in
<motion.div
  initial={{ opacity: 0 }}
  animate={{ opacity: 1 }}
>
  {/* Aparici√≥n suave */}
</motion.div>
```

### Responsive Design
```typescript
// Mobile-first approach
className="
  grid
  grid-cols-1              // üì± Mobile: 1 columna
  lg:grid-cols-3           // üíª Desktop: 3 columnas
  gap-6                    // Espacio uniforme
"

// Columnas
className="lg:col-span-2"  // 2/3 en desktop
className="lg:col-span-1"  // 1/3 en desktop
```

---

## üîó Integraci√≥n con Otros Componentes

### NewAuthContext
```typescript
import { useAuth } from "@/context/NewAuthContext";

export default function OrdersPage() {
  useAuth(); // Ensure user is authenticated
  
  // Si no hay sesi√≥n, NewAuthContext redirige a /login
  // El x-user-id se obtiene autom√°ticamente en fetchAPI()
}
```

### Router (Next.js)
```typescript
import { useRouter, useParams } from "next/navigation";

const router = useRouter();
const params = useParams();

// Navegaci√≥n
router.push("/orders");              // Lista
router.push(`/orders/${order.id}`);  // Detalle
router.push("/productos");           // Explorar
router.push("/");                    // Home

// Obtener ID de URL
const orderId = params.id as string;
```

### CartAPI
```typescript
// Despu√©s de crear pedido en /checkout, navegar a /orders
// El flujo completo:
Checkout ‚Üí ordersAPI.create() ‚Üí setOrderId() ‚Üí /orders/{id}
```

---

## üìä Flujo Completo de Usuario

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              FLUJO DE PEDIDOS: DE CHECKOUT A DETALLE            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

1Ô∏è‚É£ Usuario completa checkout en /checkout
   ‚îÇ
   ‚îú‚îÄ> handlePayment() ejecuta ordersAPI.create()
   ‚îÇ
   ‚îú‚îÄ> Response: { id: "abc123", status: "pending", total: 164.97, ... }
   ‚îÇ
   ‚îî‚îÄ> setOrderId("abc123")

2Ô∏è‚É£ Pantalla de confirmaci√≥n muestra "Pedido #ABC123"
   ‚îÇ
   ‚îî‚îÄ> Usuario puede hacer clic en "Ver mis pedidos"

3Ô∏è‚É£ Navegaci√≥n a /orders
   ‚îÇ
   ‚îú‚îÄ> useAuth() verifica autenticaci√≥n
   ‚îÇ
   ‚îú‚îÄ> useEffect() ‚Üí fetchOrders()
   ‚îÇ
   ‚îú‚îÄ> const data = await ordersAPI.getAll()
   ‚îÇ   ‚îî‚îÄ> GET /api/orders?limit=50&offset=0
   ‚îÇ       ‚îî‚îÄ> Header: x-user-id: {userId}
   ‚îÇ
   ‚îú‚îÄ> setOrders(data.orders)
   ‚îÇ
   ‚îî‚îÄ> UI muestra lista de pedidos

4Ô∏è‚É£ Usuario ve su nuevo pedido en la lista
   ‚îÇ
   ‚îú‚îÄ> Tarjeta con badge amarillo "Pendiente"
   ‚îú‚îÄ> Fecha: "9 de octubre de 2025"
   ‚îú‚îÄ> Total: "‚Ç¨164,97"
   ‚îÇ
   ‚îî‚îÄ> Click en tarjeta ‚Üí router.push(`/orders/${order.id}`)

5Ô∏è‚É£ Navegaci√≥n a /orders/abc123
   ‚îÇ
   ‚îú‚îÄ> useParams() obtiene id = "abc123"
   ‚îÇ
   ‚îú‚îÄ> useEffect() ‚Üí fetchOrderDetail()
   ‚îÇ
   ‚îú‚îÄ> const data = await ordersAPI.getById("abc123")
   ‚îÇ   ‚îî‚îÄ> GET /api/orders/abc123
   ‚îÇ       ‚îî‚îÄ> Header: x-user-id: {userId}
   ‚îÇ
   ‚îú‚îÄ> setOrder(data)
   ‚îÇ
   ‚îî‚îÄ> UI muestra detalle completo

6Ô∏è‚É£ Usuario ve todos los detalles
   ‚îÇ
   ‚îú‚îÄ> Header: "Pedido #ABC123" + Badge "Pendiente"
   ‚îú‚îÄ> Productos con im√°genes y precios
   ‚îú‚îÄ> Resumen de totales
   ‚îú‚îÄ> Direcci√≥n de env√≠o
   ‚îú‚îÄ> M√©todo de pago
   ‚îú‚îÄ> Notas del pedido
   ‚îÇ
   ‚îî‚îÄ> Bot√≥n "Cancelar pedido" (porque status = "pending")

7Ô∏è‚É£ Usuario decide cancelar
   ‚îÇ
   ‚îú‚îÄ> Click en "Cancelar pedido"
   ‚îÇ
   ‚îú‚îÄ> Confirm dialog: "¬øEst√°s seguro...?"
   ‚îÇ
   ‚îú‚îÄ> Usuario confirma
   ‚îÇ
   ‚îú‚îÄ> handleCancelOrder() ejecuta:
   ‚îÇ   ‚îî‚îÄ> await ordersAPI.cancel("abc123")
   ‚îÇ       ‚îî‚îÄ> DELETE /api/orders/abc123
   ‚îÇ
   ‚îú‚îÄ> await fetchOrderDetail() (refresh)
   ‚îÇ
   ‚îî‚îÄ> Estado actualizado: status = "cancelled"

8Ô∏è‚É£ UI actualizada autom√°ticamente
   ‚îÇ
   ‚îú‚îÄ> Badge cambia a rojo "Cancelado"
   ‚îú‚îÄ> Descripci√≥n: "Este pedido ha sido cancelado"
   ‚îú‚îÄ> Bot√≥n "Cancelar pedido" desaparece
   ‚îÇ
   ‚îî‚îÄ> Usuario puede volver a /orders para ver lista actualizada
```

---

## üìà M√©tricas de √âxito

| M√©trica | Resultado | Estado |
|---------|-----------|--------|
| P√°ginas creadas | 2 | ‚úÖ |
| L√≠neas de c√≥digo | 636 | ‚úÖ |
| TypeScript errors | 0 | ‚úÖ |
| Estados UI | 8 (loading, error, empty, 5 estados de pedido) | ‚úÖ |
| Endpoints integrados | 3 (getAll, getById, cancel) | ‚úÖ |
| Casos de uso | 6 validados | ‚úÖ |
| Responsive design | Mobile + Desktop | ‚úÖ |
| Animaciones | Framer Motion | ‚úÖ |
| Iconos | Lucide React (12 iconos) | ‚úÖ |
| Formato de datos | Fechas + Moneda (es-ES) | ‚úÖ |

---

## üöÄ Pr√≥ximos Pasos

### Alta Prioridad
- [ ] **Arreglar P√°gina de Producto** (`/productos/[id]`)
  - Restaurar archivo corrupto
  - Aplicar gu√≠a de `docs/INTEGRACION_DETALLE_PRODUCTO.md`
  - Integrar `productsAPI.getById()`
  - Tiempo estimado: 2 horas

### Media Prioridad
- [ ] **Link desde Checkout a Orders**
  - En pantalla de √©xito de `/checkout`
  - Bot√≥n "Ver mi pedido" ‚Üí `/orders/{orderId}`
  - Tiempo estimado: 15 minutos

- [ ] **Navegaci√≥n en Navbar**
  - Agregar link "Mis Pedidos" en navbar
  - Solo visible si usuario est√° autenticado
  - Tiempo estimado: 30 minutos

### Baja Prioridad
- [ ] **Admin: Gesti√≥n de Pedidos** (`/admin/pedidos`)
  - Listar todos los pedidos (no solo del usuario)
  - Actualizar estado con `ordersAPI.updateStatus()`
  - Agregar tracking number
  - Dashboard de estad√≠sticas con `ordersAPI.getStats()`
  - Tiempo estimado: 4 horas

- [ ] **Filtros en Lista de Pedidos**
  - Filtrar por estado: pending, processing, shipped, etc.
  - B√∫squeda por ID de pedido
  - Ordenar por fecha (m√°s reciente primero)
  - Tiempo estimado: 2 horas

- [ ] **Paginaci√≥n**
  - Si usuario tiene >50 pedidos
  - Botones "Anterior" y "Siguiente"
  - Usar `limit` y `offset` de `ordersAPI.getAll()`
  - Tiempo estimado: 1 hora

---

## üìö Documentaci√≥n Relacionada

- üìñ [Gu√≠a Completa de Integraci√≥n APIs](./GUIA_INTEGRACION_APIS.md) - Secci√≥n 4: Pedidos
- üí≥ [Checkout Integrado](./CHECKOUT_INTEGRADO.md) - Integraci√≥n previa
- üõí [Carrito Integrado](./CARRITO_INTEGRADO.md) - Paso anterior
- üì¶ [Detalle de Producto](./INTEGRACION_DETALLE_PRODUCTO.md) - Gu√≠a pendiente
- üîß [API Helpers](../src/lib/api.ts) - `ordersAPI` completo

---

## üéâ CONCLUSI√ìN

### Logros de Esta Integraci√≥n
‚úÖ **2 p√°ginas completas** creadas desde cero  
‚úÖ **Lista de pedidos** con estados visuales profesionales  
‚úÖ **Detalle completo** con productos, totales, y tracking  
‚úÖ **Cancelaci√≥n de pedidos** con confirmaci√≥n y refresh  
‚úÖ **8 estados de UI** perfectamente manejados  
‚úÖ **0 errores TypeScript** - c√≥digo 100% limpio  
‚úÖ **Responsive design** mobile y desktop  
‚úÖ **Animaciones suaves** con Framer Motion  

### Flujo E-Commerce Actualizado
```
üè† Home ‚Üí üì¶ Productos ‚Üí üõí Carrito ‚Üí üí≥ Checkout ‚Üí ‚úÖ Confirmaci√≥n ‚Üí üìã Pedidos
           ‚úÖ            ‚úÖ           ‚úÖ             ‚úÖ              üéØ AHORA
```

### Impacto
üéØ **Funcionalidad completa de pedidos**: Los usuarios ahora pueden ver, rastrear y cancelar sus pedidos  
üìä **Historial completo**: Todos los pedidos guardados con detalles completos  
üé® **UX profesional**: Estados visuales claros con iconos y colores  
üîÑ **Sincronizaci√≥n perfecta**: Refresh autom√°tico despu√©s de acciones  
üöÄ **Base s√≥lida**: Preparado para admin panel y notificaciones  

---

## üôå Hito Alcanzado

Esta integraci√≥n completa el **flujo completo del usuario** en GlowHair:
- De crear cuenta a **hacer compras**
- De productos a **pedidos confirmados**
- De carrito vac√≠o a **historial completo**

**Pr√≥ximo desaf√≠o:** Arreglar p√°gina de detalle de producto y completar admin panel üéØ

---

**Commit:** `7e07348`  
**Estado:** ‚úÖ **INTEGRACI√ìN COMPLETA**  
**Fecha:** Octubre 9, 2025  
**Versi√≥n:** 1.0.0  
**P√°ginas:** 2/2 (100%)
